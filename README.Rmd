<!-- README.md is generated from README.Rmd. Please edit that file -->

tidystats
---------------

**Authors:** [Willem Sleegers](http://willemsleegers.com/), [Arnoud Plantinga](http://www.arnoudplantinga.nl/)<br/>
**License:** [MIT](https://opensource.org/licenses/MIT)

`tidystats` is a package to easily create a text file containing the output of statistical models. The goal of this package is to have researchers accompany their manuscript with an organized data file of statistical results, based on [tidy data](http://vita.had.co.nz/papers/tidy-data.html) principles, in order to greatly improve the reliability of meta-research, and especially to reduce the efforts needed to perform this type of research.

Besides enabling you to create an organized data file of statistical results, the `tidystats` package also contains functions to help you report statistics in APA style using [R Markdown](http://rmarkdown.rstudio.com).

Please see below for instructions on how to install and use this package. **Do note that the package is currently in development and may contain bugs.**

### Installation

`tidystats` can be installed from Github using [devtools](https://github.com/hadley/devtools). 

```{r, eval = FALSE}
library(devtools)
install_github("willemsleegers/tidystats")
```

### Setup

Load the package and start by creating an empty list to store the results of statistical models in.

```{r setup, warning = FALSE}
library(tidystats)

results <- list()
```

### Usage

The main function is `add_stats()`. The function has 2 necessary arguments:

- `model`: The statistical model you want to add to the list (e.g., the output of `t.test()`)
- `results`: The list you want to add the statistical output to

Optionally you can also add an identifier, type, a subset of the statistics, whether the analysis was confirmatory or exploratory, and additional notes using the `identifier`, `type`, `statistics`, `confirmatory`, and `notes` arguments, respectively. 

The identifier is used to identify the model (e.g., 'weight_height_correlation'). If you do not provide one, one is automatically created for you (albeit not a very descriptive one).

The `type` argument is used to indicate whether the statistical test is a hypothesis test, manipulation check, contrast analysis, or other kind of analysis. This can be used to distinguish the vital statistical tests from those less relevant.

The `statistics` argument is used to select a subset of statistics that you want to add to the results list, in case this is desired.

The `confirmatory` argument is used to indicate whether the test was confirmatory or exploratory. It can also be ommitted.

The `notes` argument is used to add additional information which you may find fruitful. Some statistical tests have default `notes` output (e.g., t-tests), which will be overwritten when a `notes` argument is supplied to the `add_stats()` function.

### Supported statistical functions

**Package:** stats

- `t.test()`
- `cor.test()`
- `lm()`
- `aov()`

### Example

In the following example we perform several statistical tests on a data set, add the output of these results to a list, and save the results to a data file.

The data set is called `cox` and contains the data of a replication attempt of CR Cox, J Arndt, T Pyszczynski, J Greenberg, A Abdollahi, S Solomon (2008, JPSP 94(4), Exp. 6) by Wissink et al. The data set is part of the `tidystats` package.

```{r}

# Paired t-test
model1 <- t.test(call_parent ~ condition, data = cox, paired = TRUE)
results <- add_stats(model1, results, identifier = "M1")

# Correlation
model2 <- cor.test(cox$call_parent, cox$call_siblings, method = "kendall", alternative = "greater")
results <- add_stats(model2, results, identifier = "M2")

# Regression
model3 <- lm(call_parent ~ condition * anxiety , data = cox)
results <- add_stats(model3, results, identifier = "M3")

# ANOVA
model4 <- aov(call_parent ~ condition * sex, data = cox)
results <- add_stats(model4, results, identifier = "M4")
```

Having added the statistical results to the list, you can convert the list to a table or to a data file, ready for sharing. The example below shows how to produce a table containing all of the statistical results.

```{r, message = FALSE, warning = FALSE}
library(dplyr)
library(knitr)

results %>%
  stats_list_to_df() %>%
  kable()
```

To write the results to a file, use `write_stats()` with the results list as the first argument. This produces a .csv file that can be shared online and that can also be used to write your Results section. In the 'example' folder you can find an examples of a data file containing the output of multiple statistical tests, as well as a markdown file demonstrating how `tidystats` can be used to create APA-styled statistical reports.

### Helper functions

#### Descriptives

Since it's common to also report descriptives in addition to the statistical results, we have added a hopefully useful `describe()` function to calculate common descriptive statistics that can be tidied and added to a results data frame. Several examples follow using the `cox` data.

```{r}
# Descriptives of the 'anxiety' variable
describe(cox, anxiety)
```

```{r}
# By condition
cox %>%
  group_by(condition) %>%
  describe(anxiety)
```

```{r}
# Descriptives of a non-numeric variable
describe(cox, condition)
```

If you use the `describe()` function from the `tidystats` package to get the descriptives, you can use the `tidy_descriptives()` function to tidy the output, and consequently add it to a results list. 

```{r}
# Adding descriptives to a results list
results <- list()

cox %>%
  describe(anxiety) %>%
  tidy_descriptives() %>%
  add_stats(results, identifier = "anxiety", type = "d", notes = "Anxious attachment style")
```
In the `add_stats()` function you can also specify which of the statistics you would like to store in the results list.

```{r}
# Adding some of the descriptives to a results list
results <- list()

cox %>%
  describe(anxiety) %>%
  tidy_descriptives() %>%
  add_stats(results, identifier = "anxiety", type = "d", statistics = c("n", "M", "SD"))
```

And of course it also works when you have groups.

```{r}
# Adding some of the descriptives to a results list
results <- list()

cox %>%
  group_by(sex) %>%
  describe(anxiety) %>%
  tidy_descriptives() %>%
  add_stats(results, identifier = "anxiety_by_sex", type = "d", statistics = c("n", "M", "SD"))
```